<!DOCTYPE html>
<html lang="en">
<head>
  <title>Starducks — Home</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <style>
    @font-face{ font-family:"HeadingCustom"; src:url("./assets/fonts/Foglihten.ttf") format("truetype"); font-display:swap; }
    @font-face{ font-family:"Alagard"; src:url("./assets/fonts/Alagard.ttf") format("truetype"); font-display:swap; }
    :root{ --bg:#000; --ink:#f2f2f2; --muted:#9aa1a6; --accent:#ff2b4d; --card:rgba(255,255,255,.08); --border:rgba(255,255,255,.15); }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; color:var(--ink); background:#000; font-family:Alagard, ui-serif, Georgia, serif; letter-spacing:.2px; overflow-x:hidden}
    #stars{position:fixed; inset:0; z-index:-1; background:#000}
    header{ position:sticky; top:0; backdrop-filter:blur(8px); background:linear-gradient(0deg, transparent, rgba(0,0,0,.65)); border-bottom:1px solid var(--border); z-index:50; }
    .row{max-width:1200px; margin:0 auto; padding:14px 18px; display:flex; align-items:center; gap:14px}
    .brand img{height:40px; display:block}
    .spacer{flex:1}
    .btn{cursor:pointer; border:1px solid var(--border); background:var(--card); color:var(--ink); padding:10px 14px; border-radius:12px; font-size:14px; transition:.2s; text-decoration:none; display:inline-flex; align-items:center; gap:10px}
    .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.12)}
    .btn.primary{background:var(--accent); border-color:transparent; color:#fff}
    footer{max-width:1200px; margin:100px auto 30px; padding:0 18px; text-align:center; color:#b5b5b5; font-size:12px; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial; }
    .glass{background:var(--card); border:1px solid var(--border); border-radius:18px; padding:18px; box-shadow:0 6px 24px rgba(0,0,0,.35)}
  </style>

  <style>
    .hero{max-width:1200px; margin:20px auto 0; padding:0 18px; display:grid; grid-template-columns:1fr; gap:20px}
    .hero-row{display:grid; grid-template-columns: 1fr 1fr; gap:20px}
    @media (max-width:900px){.hero-row{grid-template-columns:1fr}}
    .sigil{width:72px; height:72px; border-radius:20px; background:radial-gradient(circle at 30% 30%, #fff 0 6px, transparent 7px),radial-gradient(circle at 70% 75%, #fff 0 6px, transparent 7px),conic-gradient(from 0deg, var(--accent), #ff7aa0 40%, #9bdcff 85%, var(--accent)); display:grid; place-items:center; box-shadow:0 0 22px rgba(255,255,255,.25); animation: float 6s ease-in-out infinite; cursor:pointer}
    .sigil::after{content:"♪"; font-size:30px; color:#000; filter:drop-shadow(0 0 4px rgba(255,255,255,.7))}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    .center-card{display:grid; place-items:center; text-align:center; min-height:140px}
    .clock-grid{display:grid; grid-template-columns:repeat(6,1fr); gap:10px; margin-top:10px}
    @media (max-width:1000px){.clock-grid{grid-template-columns:repeat(3,1fr)}}
    .clock{padding:14px 12px; border:1px dashed var(--border); border-radius:18px; background:rgba(255,255,255,.04); text-align:center; transform:rotate(-1deg)}
    .clock b{display:block; font-family:HeadingCustom, Impact; letter-spacing:1px; margin-bottom:6px}
    .clock span{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; font-size:14px}
    .section{max-width:1200px; margin:22px auto; padding:0 18px}
    .post{border:1px solid var(--border); border-radius:18px; overflow:hidden; margin:16px 0; background:rgba(0,0,0,.35)}
    .post .top{display:flex; align-items:center; gap:12px; padding:12px}
    .avatar{width:34px; height:34px; border-radius:50%; object-fit:cover; border:1px solid var(--border)}
    .post .img{width:100%; display:block; max-height:520px; object-fit:cover; background:#070707}
    .post .body{padding:12px 14px; line-height:1.6}
    .meta{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; color:#bfc6cc; font-size:13px}
    .name{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:600; color:#fff}
    .actions{display:flex; gap:8px; padding:10px 12px}
    .actions .btn img{width:16px; height:16px}
  </style>
</head>
<body>
  <canvas id="stars"></canvas>
  <header>
    <div class="row">
      <a class="brand" href="index.html" aria-label="Starducks Logo"><img src="assets/logo.svg" alt="Starducks"></a>
      <div class="spacer"></div>
      <a class="btn" href="login.html">Join</a>
    </div>
  </header>

  <section class="hero">
    <div class="hero-row">
      <div class="glass center-card">
        <div>
          <h2 style="font-family:HeadingCustom,Impact;margin:0 0 8px">Join Starducks</h2>
          <p style="opacity:.85;margin:0 0 12px">Sign up or sign in to start creating.</p>
          <a class="btn primary" href="login.html">Join</a>
        </div>
      </div>
      <div class="glass" style="display:flex; align-items:center; gap:16px; min-height:140px">
        <div class="sigil" id="songBadge" title="Double‑click to manage"></div>
        <div>
          <h2 style="font-family:HeadingCustom,Impact;margin:0 0 6px">Today’s tune</h2>
          <div id="songLinkWrap" style="opacity:.9">Tap to open on YouTube.</div>
          <small class="meta">Tip: double‑click the symbol to manage (access key required).</small>
        </div>
      </div>
    </div>

    <div class="center-card" style="margin-top:12px">
      <a class="btn" href="chat.html">Go to PUBLIC CHAT</a>
    </div>

    <div class="glass">
      <h3 style="font-family:HeadingCustom,Impact;margin:0 0 8px">World Clocks</h3>
      <div class="clock-grid" id="clocks"></div>
    </div>
  </section>

  <section class="section">
    <div class="glass">
      <h3 style="font-family:HeadingCustom,Impact;margin:0 0 8px">Latest from Creators</h3>
      <div id="feed"></div>
    </div>
  </section>

  <footer>Design by Uefa Chankarn</footer>

  <script>

  const starCanvas = document.getElementById('stars');
  if(starCanvas){
    const ctx = starCanvas.getContext('2d'); let W,H,stars=[];
    function resize(){W=starCanvas.width=innerWidth; H=starCanvas.height=innerHeight} addEventListener('resize', resize); resize();
    function makeStars(n=1600){ stars=[...Array(n)].map(()=>({x:Math.random()*W,y:Math.random()*H,z:Math.random()*1.6+.2,r:Math.random()*1.3+.2,v:Math.random()*0.28+.05})) } makeStars();
    (function loop(){ ctx.fillStyle='#000'; ctx.fillRect(0,0,W,H); for(const s of stars){ s.y+=s.v*s.z; if(s.y>H) s.y=0, s.x=Math.random()*W; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle='rgba(255,255,255,'+(0.55+Math.random()*0.45)+')'; ctx.fill(); } requestAnimationFrame(loop) })();
  }

  const store={get(k,d){try{return JSON.parse(localStorage.getItem(k))??d}catch{return d}}, set(k,v){localStorage.setItem(k,JSON.stringify(v))}};
  const state = { user: store.get('user', null), creators: store.get('creators', {}), posts: store.get('posts', []), chat: store.get('chat', []), songURL: store.get('songURL', '') };
  function save(){ store.set('user',state.user); store.set('creators',state.creators); store.set('posts',state.posts); store.set('chat',state.chat); store.set('songURL',state.songURL); }
  const CODE_CREATOR = atob("MTIwNw==");  // hidden
  const CODE_SONG = atob("MjYyNg==");     // hidden
  function notifyEmail(msg){ console.log('Notify → uefa.sorawit.chankarn@gmail.com :', msg); }

    // Home logic
    function drawClocks(){ const zones=[
      {label:'NYC',zone:'America/New_York'},{label:'Bangkok',zone:'Asia/Bangkok'},
      {label:'Tokyo',zone:'Asia/Tokyo'},{label:'LA',zone:'America/Los_Angeles'},
      {label:'Paris',zone:'Europe/Paris'},{label:'Seoul',zone:'Asia/Seoul'}
    ]; const g=document.getElementById('clocks'); g.innerHTML='';
      zones.forEach(z=>{ const d=document.createElement('div'); d.className='clock'; d.innerHTML=`<b>${z.label}</b><span>${new Date().toLocaleString([], {hour12:false,timeZone:z.zone}).replace(',', ' •')}</span>`; g.appendChild(d); });
    }
    setInterval(drawClocks,1000); drawClocks();

    function renderFeed(){ const F=document.getElementById('feed'); F.innerHTML='';
      const items = state.posts.filter(p=> state.creators[p.email]); // only creators
      if(items.length===0){ F.innerHTML='<div style="opacity:.75">No posts yet.</div>'; return; }
      for(const p of items){ const wrap=document.createElement('article'); wrap.className='post';
        const flag = p.country ? p.country.replace(/./g,c=>String.fromCodePoint(127397 + c.charCodeAt())) : '';
        wrap.innerHTML=`
          <div class="top">
            <img class="avatar" src="${p.avatar||('https://unavatar.io/'+encodeURIComponent(p.email))}" alt=""/>
            <div>
              <div class="name">${p.author} <span style="font-size:18px">${flag}</span></div>
              <div class="meta">${new Date(p.ts).toLocaleString()}</div>
            </div>
          </div>
          ${p.img?`<img class="img" src="${p.img}" alt="">`:''}
          <div class="body">${p.body}</div>
          <div class="actions">
            <button class="btn flight" data-id="${p.id}"><img src="assets/plane.svg" alt=""> Flight <small class="meta">${p.flights||0}</small></button>
            <button class="btn commentBtn" data-id="${p.id}">Comment</button>
          </div>`;
        F.appendChild(wrap);
      }
    }
    document.addEventListener('click', e=>{
      if(e.target.closest('.flight')){ const id=e.target.closest('.flight').dataset.id; const p=state.posts.find(x=>x.id===id); p.flights=(p.flights||0)+1; save(); renderFeed(); }
      if(e.target.closest('.commentBtn')){ if(!state.user) return alert('Please sign in on the Join page.'); const id=e.target.closest('.commentBtn').dataset.id; const text=prompt('Comment'); if(!text) return; const p=state.posts.find(x=>x.id===id); (p.comments||(p.comments=[])).push({by: state.user?.name||'Guest', text, ts: Date.now()}); save(); renderFeed(); }
    });

    // Song (double-click to set, tap to open)
    function updateSongUI(){ if(state.songURL){ document.getElementById('songLinkWrap').innerHTML = `<a class="btn" target="_blank" rel="noopener" href="${state.songURL}">Open on YouTube</a>`; } }
    document.getElementById('songBadge').onclick = ()=>{ if(state.songURL) window.open(state.songURL,'_blank'); };
    document.getElementById('songBadge').ondblclick = ()=>{
      const key=prompt('Enter access key'); if(key!==CODE_SONG) return alert('Wrong key.');
      const url=prompt('YouTube URL'); if(!url||!/^https?:\/\//.test(url)) return alert('Invalid URL'); state.songURL=url; save(); updateSongUI();
    };
    updateSongUI();

    // Daily stat (view)
    (function stats(){ const key='stats_'+new Date().toISOString().slice(0,10); const s=store.get(key,{views:0,signups:0,posts:0}); s.views++; store.set(key,s); })();

    renderFeed();
  </script>
</body>
</html>
